скачать репозиторий на компьютер

    git clone https://github.com/a-moshchenko/myproject.git

Этот сайт создан для автоматизации определения лучшего сотрудника квартала.

                   Cайт предоставляет основные функции:
              - просмотр всех сотрудников компании
              - возможность оставить голос(один сотрудник может проголосовать один раз на квартал, за каждого)
              - просмотр количества голосов за выбраного сотрудника
              - реализован поиск по имени
              - результат голосования автоматически отправляется на указаный почтовый адрес в формате PDF
              - загрузка всех сотрудников происходит методом парсинга файла employee.xlsx
                также обновление происходит каждый день в указаное время
              - логин и пароль по умолчанию это номер телефона сотрудника(есть возможость изменить пароль)
              -

Для начала нужно установить Postgresql 'https://www.postgresql.org/download/linux/ubuntu/', далее нужно создать пользователя и базу данных.
        sudo -u postgres psql

    В качестве примера будет использоваться база под названием myproject:

        postgres=# CREATE DATABASE myproject;

    Далее вам необходимо создать нового пользователя базы данных (myprojectuser) для того, чтобы подключиться к базе данных и взаимодействовать с ней

        postgres=# CREATE USER myprojectuser WITH PASSWORD 'password';

    Теперь последнее, что необходимо сделать, это дать только что созданному пользователю права доступа к созданной базе:

        postgres=# GRANT ALL PRIVILEGES ON DATABASE myproject TO myprojectuser;

    Теперь нужно настроить базу данных. Откройте в редакторе файл по пути myproject/vote/vote/settings.py.
      Ближе к концу файла вы увидите секцию DATABASES, которая выглядит так:

      DATABASES = {
          'default': {
                      'ENGINE': 'django.db.backends.postgresql_psycopg2',
                      'NAME': 'myproject',
                      'USER': 'myprojectuser',
                      'PASSWORD': 'password',
                      'HOST': 'localhost',
                      'PORT': '',
                  }
      }

      в качестве используемой базы данных (графа “NAME”) пропишите название своей базы данных.Также необходимо добавить учетные данные для входа в систему: понадобится имя пользователя, пароль и хост для подключения (графы “USER”, “PASSWORD”, “HOST”)


В конце файла settings.py меняем значение почты куда будут отправлятся результаты

    RESULT_TO_EMAIL = 'alexssssf@gmail.com'

результаты собираются первого числа первого месяца квартала

Файл с которого парсится вся база находится по пути myproject/vote/init_data/employee.xlsx
информация должна размещаться в таком порядке:

   |имя|фамилия|должность|отдел|номер телефона(как текст)|путь к фотографии|

ВАЖНО!!!!!! Менять название файла запрещено, номер должен распознаваться как текст(Символ «'» (апостроф) является символом принудительного форматирования данных «как текст»).

Установить VENV если не установлен:

    sudo apt install python3-venv

После того, как настроили базу данных устанавливаем зависимости, запускаем миграции и заполняем базу:

    cd myproject
    . ./bin/run

    Задаем логин и пароль администратора

Для запуска локального dev сервера - python3 manage.py runserver


После всего этого настраиваем cron, для запуска парсера ежедневно:

    crontab -e

* 0 * * *  ~/abs_path/myproject/myvenv/bin/python  ~/abs_path/myproject/vote/manage.py load_from_excel
